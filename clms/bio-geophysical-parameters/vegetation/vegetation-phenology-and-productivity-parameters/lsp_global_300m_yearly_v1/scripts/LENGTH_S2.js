//VERSION=3
const factor = 1; 
const offset = 0; 

function setup() {
  return {
    
    input: ["LENGTH_S2", "dataMask"],
    output: [
      { id: "default", bands: 4, sampleType: "UINT8" },
      { id: "index", bands: 1, sampleType: "FLOAT32" },
      { id: "eobrowserStats", bands: 2, sampleType: "FLOAT32" },
      { id: "dataMask", bands: 1 },
    ],
  };
}

function evaluatePixel(samples) {
  
  var originalValue = samples.LENGTH_S2;

  let val = originalValue * factor + offset;

  let dataMask = samples.dataMask;

  const indexVal = dataMask === 1 ? val : NaN;
  const imgVals = visualizer.process(val);

  return {
    default: imgVals.concat(dataMask * 255),
    index: [indexVal],
    eobrowserStats: [val, dataMask],
    dataMask: [dataMask],
  };
}


const ColorBar = [[1.0, [68, 1, 84]], [2.0, [68, 2, 86]], [4.0, [69, 4, 87]], [5.0, [69, 5, 89]], [7.0, [70, 7, 90]], [8.0, [70, 8, 92]], [10.0, [70, 10, 93]], [11.0, [70, 11, 94]], [12.0, [71, 13, 96]], [14.0, [71, 14, 97]], [15.0, [71, 16, 99]], [17.0, [71, 17, 100]], [18.0, [71, 19, 101]], [20.0, [72, 20, 103]], [21.0, [72, 22, 104]], [22.0, [72, 23, 105]], [24.0, [72, 24, 106]], [25.0, [72, 26, 108]], [27.0, [72, 27, 109]], [28.0, [72, 28, 110]], [30.0, [72, 29, 111]], [31.0, [72, 31, 112]], [33.0, [72, 32, 113]], [34.0, [72, 33, 115]], [35.0, [72, 35, 116]], [37.0, [72, 36, 117]], [38.0, [72, 37, 118]], [40.0, [72, 38, 119]], [41.0, [72, 40, 120]], [43.0, [72, 41, 121]], [44.0, [71, 42, 122]], [45.0, [71, 44, 122]], [47.0, [71, 45, 123]], [48.0, [71, 46, 124]], [50.0, [71, 47, 125]], [51.0, [70, 48, 126]], [53.0, [70, 50, 126]], [54.0, [70, 51, 127]], [55.0, [70, 52, 128]], [57.0, [69, 53, 129]], [58.0, [69, 55, 129]], [60.0, [69, 56, 130]], [61.0, [68, 57, 131]], [63.0, [68, 58, 131]], [64.0, [68, 59, 132]], [65.0, [67, 61, 132]], [67.0, [67, 62, 133]], [68.0, [66, 63, 133]], [70.0, [66, 64, 134]], [71.0, [66, 65, 134]], [73.0, [65, 66, 135]], [74.0, [65, 68, 135]], [76.0, [64, 69, 136]], [77.0, [64, 70, 136]], [78.0, [63, 71, 136]], [80.0, [63, 72, 137]], [81.0, [62, 73, 137]], [83.0, [62, 74, 137]], [84.0, [62, 76, 138]], [86.0, [61, 77, 138]], [87.0, [61, 78, 138]], [88.0, [60, 79, 138]], [90.0, [60, 80, 139]], [91.0, [59, 81, 139]], [93.0, [59, 82, 139]], [94.0, [58, 83, 139]], [96.0, [58, 84, 140]], [97.0, [57, 85, 140]], [98.0, [57, 87, 140]], [100.0, [56, 88, 140]], [101.0, [56, 89, 140]], [103.0, [55, 90, 140]], [104.0, [55, 91, 141]], [106.0, [54, 92, 141]], [107.0, [54, 93, 141]], [108.0, [53, 94, 141]], [110.0, [53, 95, 141]], [111.0, [52, 96, 141]], [113.0, [52, 97, 141]], [114.0, [51, 98, 141]], [116.0, [51, 99, 141]], [117.0, [50, 100, 142]], [119.0, [50, 101, 142]], [120.0, [49, 102, 142]], [121.0, [49, 103, 142]], [123.0, [49, 104, 142]], [124.0, [48, 105, 142]], [126.0, [48, 106, 142]], [127.0, [47, 107, 142]], [129.0, [47, 108, 142]], [130.0, [46, 109, 142]], [131.0, [46, 110, 142]], [133.0, [46, 111, 142]], [134.0, [45, 112, 142]], [136.0, [45, 113, 142]], [137.0, [44, 113, 142]], [139.0, [44, 114, 142]], [140.0, [44, 115, 142]], [141.0, [43, 116, 142]], [143.0, [43, 117, 142]], [144.0, [42, 118, 142]], [146.0, [42, 119, 142]], [147.0, [42, 120, 142]], [149.0, [41, 121, 142]], [150.0, [41, 122, 142]], [151.0, [41, 123, 142]], [153.0, [40, 124, 142]], [154.0, [40, 125, 142]], [156.0, [39, 126, 142]], [157.0, [39, 127, 142]], [159.0, [39, 128, 142]], [160.0, [38, 130, 142]], [162.0, [38, 130, 142]], [163.0, [38, 130, 142]], [164.0, [37, 131, 142]], [166.0, [37, 132, 142]], [167.0, [37, 133, 142]], [169.0, [36, 134, 142]], [170.0, [36, 135, 142]], [172.0, [35, 136, 142]], [173.0, [35, 137, 142]], [174.0, [35, 138, 141]], [176.0, [34, 139, 141]], [177.0, [34, 140, 141]], [179.0, [34, 141, 141]], [180.0, [33, 142, 141]], [182.0, [33, 144, 141]], [183.0, [33, 144, 140]], [184.0, [33, 146, 140]], [186.0, [32, 146, 140]], [187.0, [32, 146, 140]], [189.0, [31, 148, 140]], [190.0, [31, 149, 139]], [192.0, [31, 150, 139]], [193.0, [31, 151, 139]], [194.0, [31, 152, 139]], [196.0, [31, 153, 138]], [197.0, [31, 154, 138]], [199.0, [30, 155, 138]], [200.0, [30, 156, 137]], [202.0, [30, 157, 137]], [203.0, [31, 158, 137]], [204.0, [31, 159, 136]], [206.0, [31, 160, 136]], [207.0, [31, 161, 136]], [209.0, [31, 161, 135]], [210.0, [31, 161, 135]], [212.0, [32, 163, 134]], [213.0, [32, 164, 134]], [215.0, [33, 165, 133]], [216.0, [33, 166, 133]], [217.0, [34, 167, 133]], [219.0, [34, 168, 132]], [220.0, [35, 169, 131]], [222.0, [36, 170, 131]], [223.0, [37, 171, 130]], [225.0, [37, 172, 130]], [226.0, [38, 173, 129]], [227.0, [39, 173, 129]], [229.0, [40, 174, 128]], [230.0, [41, 175, 127]], [232.0, [42, 176, 127]], [233.0, [43, 177, 126]], [235.0, [45, 178, 125]], [236.0, [46, 179, 124]], [237.0, [47, 180, 124]], [239.0, [48, 181, 123]], [240.0, [50, 182, 122]], [242.0, [51, 182, 121]], [243.0, [53, 183, 121]], [245.0, [54, 184, 120]], [246.0, [56, 185, 119]], [247.0, [57, 186, 118]], [249.0, [59, 187, 117]], [250.0, [60, 188, 116]], [252.0, [63, 188, 115]], [253.0, [64, 189, 114]], [255.0, [65, 190, 113]], [256.0, [67, 191, 112]], [258.0, [69, 192, 111]], [259.0, [71, 193, 110]], [260.0, [73, 193, 109]], [262.0, [75, 194, 108]], [263.0, [77, 195, 107]], [265.0, [79, 196, 106]], [266.0, [81, 197, 105]], [268.0, [83, 197, 104]], [269.0, [85, 198, 103]], [270.0, [87, 199, 101]], [272.0, [89, 200, 100]], [273.0, [91, 200, 99]], [275.0, [94, 201, 98]], [276.0, [95, 202, 96]], [278.0, [98, 203, 95]], [279.0, [101, 203, 94]], [280.0, [103, 204, 92]], [282.0, [104, 205, 91]], [283.0, [107, 205, 90]], [285.0, [110, 206, 88]], [286.0, [111, 207, 87]], [288.0, [114, 208, 86]], [289.0, [117, 208, 84]], [290.0, [118, 209, 83]], [292.0, [121, 209, 81]], [293.0, [124, 210, 80]], [295.0, [126, 211, 78]], [296.0, [129, 211, 77]], [298.0, [131, 212, 75]], [299.0, [134, 213, 73]], [301.0, [137, 213, 72]], [302.0, [139, 214, 70]], [303.0, [142, 214, 69]], [305.0, [144, 215, 67]], [306.0, [147, 215, 65]], [308.0, [149, 216, 64]], [309.0, [151, 216, 62]], [311.0, [155, 217, 60]], [312.0, [157, 217, 59]], [313.0, [160, 218, 57]], [315.0, [162, 218, 55]], [316.0, [165, 219, 54]], [318.0, [168, 219, 52]], [319.0, [170, 220, 50]], [321.0, [173, 220, 48]], [322.0, [176, 221, 47]], [323.0, [178, 221, 45]], [325.0, [181, 222, 43]], [326.0, [184, 222, 41]], [328.0, [186, 222, 40]], [329.0, [189, 223, 38]], [331.0, [192, 223, 37]], [332.0, [194, 223, 35]], [333.0, [197, 224, 33]], [335.0, [200, 224, 32]], [336.0, [202, 225, 31]], [338.0, [205, 225, 29]], [339.0, [208, 225, 28]], [341.0, [210, 226, 27]], [342.0, [213, 226, 26]], [344.0, [216, 226, 25]], [345.0, [218, 227, 25]], [346.0, [221, 227, 24]], [348.0, [223, 227, 24]], [349.0, [226, 228, 24]], [351.0, [229, 228, 25]], [352.0, [231, 228, 25]], [354.0, [234, 229, 26]], [355.0, [236, 229, 27]], [356.0, [239, 229, 28]], [358.0, [241, 229, 29]], [359.0, [244, 230, 30]], [361.0, [246, 230, 32]], [362.0, [248, 230, 33]], [364.0, [251, 231, 35]], [365.0, [253, 231, 37]]];
const visualizer = new ColorRampVisualizer(ColorBar);
