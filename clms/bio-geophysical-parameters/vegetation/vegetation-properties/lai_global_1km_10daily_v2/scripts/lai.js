//VERSION=3
const factor = 1 / 30;
const offset = 0;

function setup() {
  return {
    // EDIT VARIABLE NAME
    input: ["LAI", "dataMask"],
    output: [
      { id: "default", bands: 4, sampleType: "UINT8" },
      { id: "index", bands: 1, sampleType: "FLOAT32" },
      { id: "eobrowserStats", bands: 2, sampleType: "FLOAT32" },
      { id: "dataMask", bands: 1 },
    ],
  };
}

function evaluatePixel(samples) {
  var originalValue = samples.LAI;

  let val = originalValue * factor + offset;

  let dataMask = samples.dataMask;

  const indexVal = dataMask === 1 ? val : NaN;
  const imgVals = visualizer.process(originalValue);

  return {
    default: imgVals.concat(dataMask * 255),
    index: [indexVal],
    eobrowserStats: [val, dataMask],
    dataMask: [dataMask],
  };
}

// EDIT COLOR BAR
const ColorBar = [
  [0, [140, 92, 8]],
  [0, [140, 92, 8]],
  [1, [141, 94, 7]],
  [2, [143, 97, 7]],
  [3, [145, 100, 7]],
  [4, [147, 102, 7]],
  [5, [149, 105, 7]],
  [6, [151, 108, 7]],
  [7, [153, 111, 7]],
  [8, [155, 113, 6]],
  [9, [157, 116, 6]],
  [10, [159, 119, 6]],
  [11, [161, 121, 6]],
  [12, [163, 124, 6]],
  [13, [164, 127, 6]],
  [14, [166, 130, 6]],
  [15, [168, 132, 6]],
  [16, [170, 135, 5]],
  [17, [172, 138, 5]],
  [18, [174, 140, 5]],
  [19, [176, 143, 5]],
  [20, [178, 146, 5]],
  [21, [180, 149, 5]],
  [22, [182, 151, 5]],
  [23, [184, 154, 4]],
  [24, [186, 157, 4]],
  [25, [187, 159, 4]],
  [26, [189, 162, 4]],
  [27, [191, 165, 4]],
  [28, [193, 168, 4]],
  [29, [195, 170, 4]],
  [30, [197, 173, 4]],
  [31, [199, 176, 3]],
  [32, [201, 178, 3]],
  [33, [203, 181, 3]],
  [34, [205, 184, 3]],
  [35, [207, 187, 3]],
  [36, [209, 189, 3]],
  [37, [210, 192, 3]],
  [38, [212, 195, 2]],
  [39, [214, 197, 2]],
  [40, [216, 200, 2]],
  [41, [218, 203, 2]],
  [42, [220, 206, 2]],
  [43, [222, 208, 2]],
  [44, [224, 211, 2]],
  [45, [226, 214, 2]],
  [46, [228, 216, 1]],
  [47, [230, 219, 1]],
  [48, [232, 222, 1]],
  [49, [233, 225, 1]],
  [50, [235, 227, 1]],
  [51, [237, 230, 1]],
  [52, [239, 233, 1]],
  [53, [241, 235, 0]],
  [54, [243, 238, 0]],
  [55, [245, 241, 0]],
  [56, [247, 244, 0]],
  [57, [249, 246, 0]],
  [58, [251, 249, 0]],
  [59, [253, 252, 0]],
  [60, [255, 255, 0]],
  [61, [250, 254, 0]],
  [62, [246, 253, 0]],
  [63, [242, 252, 0]],
  [64, [238, 251, 0]],
  [65, [233, 250, 0]],
  [66, [229, 249, 0]],
  [67, [225, 248, 0]],
  [68, [221, 247, 0]],
  [69, [216, 246, 0]],
  [70, [212, 245, 0]],
  [71, [208, 244, 0]],
  [72, [204, 244, 0]],
  [73, [199, 243, 0]],
  [74, [195, 242, 0]],
  [75, [191, 241, 0]],
  [76, [187, 240, 0]],
  [77, [182, 239, 0]],
  [78, [178, 238, 0]],
  [79, [174, 237, 0]],
  [80, [170, 236, 0]],
  [81, [165, 235, 0]],
  [82, [161, 234, 0]],
  [83, [157, 233, 0]],
  [84, [153, 233, 0]],
  [85, [148, 232, 0]],
  [86, [144, 231, 0]],
  [87, [140, 230, 0]],
  [88, [136, 229, 0]],
  [89, [131, 228, 0]],
  [90, [127, 227, 0]],
  [91, [123, 226, 0]],
  [92, [119, 225, 0]],
  [93, [114, 224, 0]],
  [94, [110, 223, 0]],
  [95, [106, 222, 0]],
  [96, [102, 222, 0]],
  [97, [97, 221, 0]],
  [98, [93, 220, 0]],
  [99, [89, 219, 0]],
  [100, [85, 218, 0]],
  [101, [80, 217, 0]],
  [102, [76, 216, 0]],
  [103, [72, 215, 0]],
  [104, [68, 214, 0]],
  [105, [63, 213, 0]],
  [106, [59, 212, 0]],
  [107, [55, 211, 0]],
  [108, [51, 211, 0]],
  [109, [46, 210, 0]],
  [110, [42, 209, 0]],
  [111, [38, 208, 0]],
  [112, [34, 207, 0]],
  [113, [29, 206, 0]],
  [114, [25, 205, 0]],
  [115, [21, 204, 0]],
  [116, [17, 203, 0]],
  [117, [12, 202, 0]],
  [118, [8, 201, 0]],
  [119, [4, 200, 0]],
  [120, [0, 200, 0]],
  [121, [0, 198, 0]],
  [122, [0, 197, 0]],
  [123, [0, 196, 0]],
  [124, [0, 195, 0]],
  [125, [0, 194, 0]],
  [126, [0, 193, 0]],
  [127, [0, 192, 0]],
  [128, [0, 191, 0]],
  [129, [0, 190, 0]],
  [130, [0, 188, 0]],
  [131, [0, 187, 0]],
  [132, [0, 186, 0]],
  [133, [0, 185, 0]],
  [134, [0, 184, 0]],
  [135, [0, 183, 0]],
  [136, [0, 182, 0]],
  [137, [0, 181, 0]],
  [138, [0, 180, 0]],
  [139, [0, 178, 0]],
  [140, [0, 177, 0]],
  [141, [0, 176, 0]],
  [142, [0, 175, 0]],
  [143, [0, 174, 0]],
  [144, [0, 173, 0]],
  [145, [0, 172, 0]],
  [146, [0, 171, 0]],
  [147, [0, 170, 0]],
  [148, [0, 168, 0]],
  [149, [0, 167, 0]],
  [150, [0, 166, 0]],
  [151, [0, 165, 0]],
  [152, [0, 164, 0]],
  [153, [0, 163, 0]],
  [154, [0, 162, 0]],
  [155, [0, 161, 0]],
  [156, [0, 160, 0]],
  [157, [0, 158, 0]],
  [158, [0, 157, 0]],
  [159, [0, 156, 0]],
  [160, [0, 155, 0]],
  [161, [0, 154, 0]],
  [162, [0, 153, 0]],
  [163, [0, 152, 0]],
  [164, [0, 151, 0]],
  [165, [0, 150, 0]],
  [166, [0, 148, 0]],
  [167, [0, 147, 0]],
  [168, [0, 146, 0]],
  [169, [0, 145, 0]],
  [170, [0, 144, 0]],
  [171, [0, 143, 0]],
  [172, [0, 142, 0]],
  [173, [0, 141, 0]],
  [174, [0, 140, 0]],
  [175, [0, 138, 0]],
  [176, [0, 137, 0]],
  [177, [0, 136, 0]],
  [178, [0, 135, 0]],
  [179, [0, 134, 0]],
  [180, [0, 133, 0]],
  [181, [0, 132, 0]],
  [182, [0, 131, 0]],
  [183, [0, 130, 0]],
  [184, [0, 128, 0]],
  [185, [0, 127, 0]],
  [186, [0, 126, 0]],
  [187, [0, 125, 0]],
  [188, [0, 124, 0]],
  [189, [0, 123, 0]],
  [190, [0, 122, 0]],
  [191, [0, 121, 0]],
  [192, [0, 120, 0]],
  [193, [0, 118, 0]],
  [194, [0, 117, 0]],
  [195, [0, 116, 0]],
  [196, [0, 115, 0]],
  [197, [0, 114, 0]],
  [198, [0, 113, 0]],
  [199, [0, 112, 0]],
  [200, [0, 111, 0]],
  [201, [0, 110, 0]],
  [202, [0, 108, 0]],
  [203, [0, 107, 0]],
  [204, [0, 106, 0]],
  [205, [0, 105, 0]],
  [206, [0, 104, 0]],
  [207, [0, 103, 0]],
  [208, [0, 102, 0]],
  [209, [0, 101, 0]],
  [210, [0, 100, 0]],
  [211, [255, 255, 255]],
  [255, [255, 255, 255]],
];
const visualizer = new ColorRampVisualizer(ColorBar);
