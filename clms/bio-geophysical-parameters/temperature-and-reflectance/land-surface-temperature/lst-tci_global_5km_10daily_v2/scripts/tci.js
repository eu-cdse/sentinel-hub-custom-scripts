//VERSION=3
const factor = 1 / 10000; // EDIT FACTOR
const offset = 0; // EDIT OFFSET

function setup() {
  return {
    // EDIT VARIABLE NAME
    input: ["TCI", "dataMask"],
    output: [
      { id: "default", bands: 4, sampleType: "UINT8" },
      { id: "index", bands: 1, sampleType: "FLOAT32" },
      { id: "eobrowserStats", bands: 2, sampleType: "FLOAT32" },
      { id: "dataMask", bands: 1 },
    ],
  };
}

function evaluatePixel(samples) {
  // EDIT VARIABLE NAME
  var originalValue = samples.TCI;

  let val = originalValue * factor + offset;

  let dataMask = samples.dataMask;

  const indexVal = dataMask === 1 ? val : NaN;
  const imgVals = visualizer.process(originalValue);

  return {
    default: imgVals.concat(dataMask * 255),
    index: [indexVal],
    eobrowserStats: [val, dataMask],
    dataMask: [dataMask],
  };
}

// EDIT COLOR BAR
const ColorBar = [
  [-6000.0, [0, 0, 0]],
  [-1000.0, [0, 0, 255]],
  [-955.0, [0, 4, 249]],
  [-910.0, [0, 9, 243]],
  [-864.0, [1, 13, 237]],
  [-819.0, [1, 18, 231]],
  [-774.0, [1, 22, 225]],
  [-729.0, [1, 27, 219]],
  [-683.0, [1, 31, 213]],
  [-638.0, [2, 36, 207]],
  [-593.0, [2, 40, 201]],
  [-548.0, [2, 45, 195]],
  [-503.0, [2, 49, 189]],
  [-457.0, [2, 54, 183]],
  [-412.0, [3, 58, 177]],
  [-367.0, [3, 63, 171]],
  [-322.0, [3, 67, 165]],
  [-276.0, [3, 72, 159]],
  [-231.0, [3, 76, 153]],
  [-186.0, [4, 81, 147]],
  [-141.0, [4, 85, 141]],
  [-95.0, [4, 90, 135]],
  [-50.0, [4, 94, 129]],
  [-5.0, [4, 98, 123]],
  [40.0, [5, 103, 117]],
  [85.0, [5, 107, 111]],
  [131.0, [5, 112, 105]],
  [176.0, [5, 116, 99]],
  [221.0, [5, 121, 93]],
  [266.0, [6, 125, 87]],
  [312.0, [6, 130, 81]],
  [357.0, [6, 134, 75]],
  [402.0, [6, 139, 69]],
  [447.0, [6, 143, 63]],
  [492.0, [7, 148, 57]],
  [538.0, [7, 152, 51]],
  [583.0, [7, 157, 45]],
  [628.0, [7, 161, 39]],
  [673.0, [7, 166, 33]],
  [719.0, [8, 170, 27]],
  [764.0, [8, 175, 21]],
  [809.0, [8, 179, 15]],
  [854.0, [14, 181, 15]],
  [899.0, [20, 183, 14]],
  [945.0, [27, 185, 14]],
  [990.0, [33, 187, 14]],
  [1035.0, [39, 189, 13]],
  [1080.0, [45, 190, 13]],
  [1126.0, [51, 192, 12]],
  [1171.0, [57, 194, 12]],
  [1216.0, [64, 196, 12]],
  [1261.0, [70, 198, 11]],
  [1307.0, [76, 200, 11]],
  [1352.0, [82, 202, 11]],
  [1397.0, [88, 204, 10]],
  [1442.0, [94, 206, 10]],
  [1487.0, [101, 208, 9]],
  [1533.0, [107, 209, 9]],
  [1578.0, [113, 211, 9]],
  [1623.0, [119, 213, 8]],
  [1668.0, [125, 215, 8]],
  [1714.0, [132, 217, 8]],
  [1759.0, [138, 219, 7]],
  [1804.0, [144, 221, 7]],
  [1849.0, [150, 223, 6]],
  [1894.0, [156, 225, 6]],
  [1940.0, [162, 227, 6]],
  [1985.0, [169, 228, 5]],
  [2030.0, [175, 230, 5]],
  [2075.0, [181, 232, 5]],
  [2121.0, [187, 234, 4]],
  [2166.0, [193, 236, 4]],
  [2211.0, [199, 238, 3]],
  [2256.0, [206, 240, 3]],
  [2302.0, [212, 242, 3]],
  [2347.0, [218, 244, 2]],
  [2392.0, [224, 246, 2]],
  [2437.0, [230, 247, 2]],
  [2482.0, [236, 249, 1]],
  [2528.0, [243, 251, 1]],
  [2573.0, [249, 253, 0]],
  [2618.0, [255, 255, 0]],
  [2663.0, [255, 253, 0]],
  [2709.0, [255, 250, 0]],
  [2754.0, [255, 248, 0]],
  [2799.0, [255, 246, 0]],
  [2844.0, [255, 243, 0]],
  [2889.0, [255, 241, 0]],
  [2935.0, [255, 239, 0]],
  [2980.0, [255, 237, 0]],
  [3025.0, [255, 234, 0]],
  [3070.0, [255, 232, 0]],
  [3116.0, [255, 230, 0]],
  [3161.0, [255, 227, 0]],
  [3206.0, [255, 225, 0]],
  [3251.0, [255, 223, 0]],
  [3296.0, [255, 220, 0]],
  [3342.0, [255, 218, 0]],
  [3387.0, [255, 216, 0]],
  [3432.0, [255, 213, 0]],
  [3477.0, [255, 211, 0]],
  [3523.0, [255, 209, 0]],
  [3568.0, [255, 207, 0]],
  [3613.0, [255, 204, 0]],
  [3658.0, [255, 202, 0]],
  [3704.0, [255, 200, 0]],
  [3749.0, [255, 197, 0]],
  [3794.0, [255, 195, 0]],
  [3839.0, [255, 193, 0]],
  [3884.0, [255, 190, 0]],
  [3930.0, [255, 188, 0]],
  [3975.0, [255, 186, 0]],
  [4020.0, [255, 183, 0]],
  [4065.0, [255, 181, 0]],
  [4111.0, [255, 179, 0]],
  [4156.0, [255, 177, 0]],
  [4201.0, [255, 174, 0]],
  [4246.0, [255, 172, 0]],
  [4291.0, [255, 170, 0]],
  [4337.0, [255, 167, 0]],
  [4382.0, [255, 165, 0]],
  [4427.0, [255, 161, 0]],
  [4472.0, [255, 157, 0]],
  [4518.0, [255, 153, 0]],
  [4563.0, [255, 149, 0]],
  [4608.0, [255, 144, 0]],
  [4653.0, [255, 140, 0]],
  [4698.0, [255, 136, 0]],
  [4744.0, [255, 132, 0]],
  [4789.0, [255, 128, 0]],
  [4834.0, [255, 124, 0]],
  [4879.0, [255, 120, 0]],
  [4925.0, [255, 116, 0]],
  [4970.0, [255, 111, 0]],
  [5015.0, [255, 107, 0]],
  [5060.0, [255, 103, 0]],
  [5106.0, [255, 99, 0]],
  [5151.0, [255, 95, 0]],
  [5196.0, [255, 91, 0]],
  [5241.0, [255, 87, 0]],
  [5286.0, [255, 83, 0]],
  [5332.0, [255, 78, 0]],
  [5377.0, [255, 74, 0]],
  [5422.0, [255, 70, 0]],
  [5467.0, [255, 66, 0]],
  [5513.0, [255, 62, 0]],
  [5558.0, [255, 58, 0]],
  [5603.0, [255, 54, 0]],
  [5648.0, [255, 50, 0]],
  [5693.0, [255, 45, 0]],
  [5739.0, [255, 41, 0]],
  [5784.0, [255, 37, 0]],
  [5829.0, [255, 33, 0]],
  [5874.0, [255, 29, 0]],
  [5920.0, [255, 25, 0]],
  [5965.0, [255, 21, 0]],
  [6010.0, [255, 17, 0]],
  [6055.0, [255, 12, 0]],
  [6101.0, [255, 8, 0]],
  [6146.0, [255, 4, 0]],
  [6191.0, [255, 0, 0]],
  [6236.0, [251, 0, 3]],
  [6281.0, [247, 0, 7]],
  [6327.0, [242, 0, 10]],
  [6372.0, [238, 0, 14]],
  [6417.0, [234, 0, 17]],
  [6462.0, [230, 0, 20]],
  [6508.0, [226, 0, 24]],
  [6553.0, [221, 0, 27]],
  [6598.0, [217, 0, 31]],
  [6643.0, [213, 0, 34]],
  [6688.0, [209, 0, 37]],
  [6734.0, [205, 0, 41]],
  [6779.0, [200, 0, 44]],
  [6824.0, [196, 0, 48]],
  [6869.0, [192, 0, 51]],
  [6915.0, [188, 0, 54]],
  [6960.0, [184, 0, 58]],
  [7005.0, [179, 0, 61]],
  [7050.0, [175, 0, 65]],
  [7095.0, [171, 0, 68]],
  [7141.0, [167, 0, 71]],
  [7186.0, [163, 0, 75]],
  [7231.0, [158, 0, 78]],
  [7276.0, [154, 0, 82]],
  [7322.0, [150, 0, 85]],
  [7367.0, [146, 0, 88]],
  [7412.0, [142, 0, 92]],
  [7457.0, [137, 0, 95]],
  [7503.0, [133, 0, 99]],
  [7548.0, [129, 0, 102]],
  [7593.0, [125, 0, 105]],
  [7638.0, [121, 0, 109]],
  [7683.0, [116, 0, 112]],
  [7729.0, [112, 0, 116]],
  [7774.0, [108, 0, 119]],
  [7819.0, [104, 0, 122]],
  [7864.0, [100, 0, 126]],
  [7910.0, [95, 0, 129]],
  [7955.0, [91, 0, 133]],
  [8000.0, [87, 0, 136]],
];
const visualizer = new ColorRampVisualizer(ColorBar);
