//VERSION=3
const factor = 1;
const offset = 0;

function setup() {
  return {
    input: ["Bare_Cover_Fraction", "dataMask"],
    output: [
      { id: "default", bands: 4, sampleType: "UINT8" },
      { id: "index", bands: 1, sampleType: "FLOAT32" },
      { id: "eobrowserStats", bands: 2, sampleType: "FLOAT32" },
      { id: "dataMask", bands: 1 },
    ],
  };
}

function evaluatePixel(samples) {
  var originalValue = samples.Bare_Cover_Fraction;

  let val = originalValue * factor + offset;

  let dataMask = samples.dataMask;

  const indexVal = dataMask === 1 ? val : NaN;
  const imgVals = visualizer.process(originalValue);

  return {
    default: imgVals.concat(dataMask * 255),
    index: [indexVal],
    eobrowserStats: [val, dataMask],
    dataMask: [dataMask],
  };
}


const ColorBar = [
  [0, [68, 1, 84]],
  [1, [68, 2, 85]],
  [2, [69, 4, 87]],
  [3, [69, 5, 88]],
  [4, [70, 7, 90]],
  [5, [70, 8, 91]],
  [6, [70, 10, 92]],
  [7, [70, 11, 94]],
  [8, [71, 13, 95]],
  [9, [71, 14, 96]],
  [10, [71, 16, 97]],
  [11, [71, 17, 99]],
  [12, [71, 19, 100]],
  [13, [72, 20, 101]],
  [14, [72, 22, 102]],
  [15, [72, 23, 103]],
  [16, [72, 24, 104]],
  [17, [72, 26, 105]],
  [18, [72, 27, 106]],
  [19, [72, 28, 107]],
  [20, [72, 29, 108]],
  [21, [72, 31, 109]],
  [22, [72, 32, 110]],
  [23, [72, 33, 111]],
  [24, [72, 34, 111]],
  [25, [71, 36, 112]],
  [26, [71, 37, 113]],
  [27, [71, 38, 114]],
  [28, [71, 39, 114]],
  [29, [71, 40, 115]],
  [30, [71, 42, 116]],
  [31, [70, 43, 116]],
  [32, [70, 44, 117]],
  [33, [70, 45, 118]],
  [34, [70, 46, 118]],
  [35, [69, 47, 119]],
  [36, [69, 48, 119]],
  [37, [69, 50, 120]],
  [38, [68, 51, 120]],
  [39, [68, 52, 121]],
  [40, [68, 53, 121]],
  [41, [67, 54, 122]],
  [42, [67, 55, 122]],
  [43, [66, 56, 123]],
  [44, [66, 58, 123]],
  [45, [65, 59, 124]],
  [46, [65, 60, 124]],
  [47, [64, 61, 124]],
  [48, [64, 62, 125]],
  [49, [63, 63, 125]],
  [50, [62, 64, 125]],
  [51, [62, 65, 125]],
  [52, [61, 66, 126]],
  [53, [61, 67, 126]],
  [54, [60, 68, 126]],
  [55, [59, 69, 126]],
  [56, [59, 70, 126]],
  [57, [58, 71, 126]],
  [58, [57, 72, 126]],
  [59, [57, 73, 126]],
  [60, [56, 74, 126]],
  [61, [55, 75, 126]],
  [62, [55, 76, 126]],
  [63, [54, 77, 126]],
  [64, [53, 78, 126]],
  [65, [52, 79, 126]],
  [66, [52, 80, 126]],
  [67, [51, 81, 126]],
  [68, [50, 82, 126]],
  [69, [49, 83, 126]],
  [70, [49, 84, 126]],
  [71, [48, 85, 126]],
  [72, [47, 86, 126]],
  [73, [46, 87, 126]],
  [74, [46, 88, 126]],
  [75, [45, 89, 126]],
  [76, [44, 90, 126]],
  [77, [43, 91, 126]],
  [78, [42, 92, 126]],
  [79, [42, 93, 126]],
  [80, [41, 94, 126]],
  [81, [40, 95, 125]],
  [82, [39, 96, 125]],
  [83, [39, 97, 125]],
  [84, [38, 98, 125]],
  [85, [37, 99, 125]],
  [86, [36, 100, 124]],
  [87, [36, 101, 124]],
  [88, [35, 102, 124]],
  [89, [34, 103, 123]],
  [90, [33, 104, 123]],
  [91, [33, 105, 123]],
  [92, [32, 106, 122]],
  [93, [31, 107, 122]],
  [94, [30, 108, 121]],
  [95, [30, 109, 121]],
  [96, [29, 110, 120]],
  [97, [28, 111, 120]],
  [98, [27, 112, 119]],
  [99, [27, 113, 119]],
  [100, [26, 114, 118]],
];
const visualizer = new ColorRampVisualizer(ColorBar);
